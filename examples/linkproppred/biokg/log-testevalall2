  0%|          | 0/4762678 [00:00<?, ?it/s]  0%|          | 6351/4762678 [00:00<01:14, 63509.45it/s]  1%|          | 53054/4762678 [00:00<00:54, 85731.38it/s]  2%|▏         | 102452/4762678 [00:00<00:40, 113994.52it/s]  3%|▎         | 150745/4762678 [00:00<00:31, 147888.32it/s]  4%|▍         | 198372/4762678 [00:00<00:24, 186455.74it/s]  5%|▌         | 249683/4762678 [00:00<00:19, 230472.40it/s]  6%|▋         | 302319/4762678 [00:00<00:16, 277223.76it/s]  7%|▋         | 352514/4762678 [00:00<00:13, 320234.79it/s]  8%|▊         | 403319/4762678 [00:00<00:12, 360179.02it/s] 10%|▉         | 454295/4762678 [00:01<00:10, 394945.44it/s] 11%|█         | 505791/4762678 [00:01<00:10, 424634.14it/s] 12%|█▏        | 556145/4762678 [00:01<00:09, 445579.35it/s] 13%|█▎        | 605911/4762678 [00:01<00:13, 298062.72it/s] 14%|█▎        | 653954/4762678 [00:01<00:12, 336367.31it/s] 15%|█▍        | 703123/4762678 [00:01<00:10, 371580.08it/s] 16%|█▌        | 752657/4762678 [00:01<00:09, 401687.14it/s] 17%|█▋        | 800823/4762678 [00:01<00:09, 422743.41it/s] 18%|█▊        | 853139/4762678 [00:01<00:08, 448573.05it/s] 19%|█▉        | 904814/4762678 [00:02<00:08, 467057.38it/s] 20%|██        | 954136/4762678 [00:02<00:08, 472024.11it/s] 21%|██        | 1009822/4762678 [00:02<00:07, 494630.56it/s] 22%|██▏       | 1060861/4762678 [00:02<00:07, 495647.83it/s] 23%|██▎       | 1111529/4762678 [00:02<00:07, 479162.39it/s] 24%|██▍       | 1160337/4762678 [00:02<00:07, 479090.52it/s] 25%|██▌       | 1211392/4762678 [00:02<00:07, 488112.08it/s] 26%|██▋       | 1260682/4762678 [00:02<00:07, 481597.25it/s] 27%|██▋       | 1309196/4762678 [00:02<00:07, 481995.55it/s] 29%|██▊       | 1357644/4762678 [00:03<00:07, 476404.49it/s] 30%|██▉       | 1405473/4762678 [00:03<00:07, 476707.23it/s] 31%|███       | 1453276/4762678 [00:03<00:06, 475210.48it/s] 32%|███▏      | 1500891/4762678 [00:03<00:11, 275751.71it/s] 32%|███▏      | 1539569/4762678 [00:03<00:10, 301735.19it/s] 33%|███▎      | 1580055/4762678 [00:03<00:09, 326696.90it/s] 34%|███▍      | 1620003/4762678 [00:03<00:09, 345584.88it/s] 35%|███▍      | 1659041/4762678 [00:03<00:08, 354940.08it/s] 36%|███▌      | 1698623/4762678 [00:04<00:08, 366287.23it/s] 36%|███▋      | 1737876/4762678 [00:04<00:08, 373783.42it/s] 37%|███▋      | 1777075/4762678 [00:04<00:07, 379063.31it/s] 38%|███▊      | 1816168/4762678 [00:04<00:07, 376382.40it/s] 39%|███▉      | 1854641/4762678 [00:04<00:07, 374713.42it/s] 40%|███▉      | 1892699/4762678 [00:04<00:07, 376011.49it/s] 41%|████      | 1930913/4762678 [00:04<00:07, 377827.00it/s] 41%|████▏     | 1968986/4762678 [00:04<00:07, 373358.41it/s] 42%|████▏     | 2006853/4762678 [00:04<00:07, 374935.75it/s] 43%|████▎     | 2045052/4762678 [00:04<00:07, 377022.23it/s] 44%|████▎     | 2083311/4762678 [00:05<00:07, 378672.63it/s] 45%|████▍     | 2121516/4762678 [00:05<00:06, 379679.39it/s] 45%|████▌     | 2160108/4762678 [00:05<00:06, 381529.04it/s] 46%|████▌     | 2198302/4762678 [00:05<00:06, 378916.27it/s] 47%|████▋     | 2236227/4762678 [00:05<00:07, 360277.64it/s] 48%|████▊     | 2272470/4762678 [00:05<00:06, 360837.74it/s] 48%|████▊     | 2309172/4762678 [00:05<00:06, 362669.52it/s] 49%|████▉     | 2346483/4762678 [00:05<00:06, 365737.07it/s] 50%|█████     | 2383139/4762678 [00:05<00:06, 364170.75it/s] 51%|█████     | 2419986/4762678 [00:06<00:06, 365449.54it/s] 52%|█████▏    | 2457206/4762678 [00:06<00:06, 367447.37it/s] 52%|█████▏    | 2494500/4762678 [00:06<00:06, 369076.90it/s] 53%|█████▎    | 2532162/4762678 [00:06<00:06, 371306.18it/s] 54%|█████▍    | 2569313/4762678 [00:06<00:05, 366834.95it/s] 55%|█████▍    | 2606023/4762678 [00:06<00:05, 365229.13it/s] 55%|█████▌    | 2642936/4762678 [00:06<00:05, 366389.25it/s] 56%|█████▋    | 2679590/4762678 [00:06<00:05, 366246.79it/s] 57%|█████▋    | 2717879/4762678 [00:06<00:05, 371083.87it/s] 58%|█████▊    | 2755011/4762678 [00:06<00:05, 370331.63it/s] 59%|█████▊    | 2793668/4762678 [00:07<00:05, 375055.83it/s] 59%|█████▉    | 2832589/4762678 [00:07<00:05, 379192.64it/s] 60%|██████    | 2871209/4762678 [00:07<00:04, 381266.49it/s] 61%|██████    | 2909614/4762678 [00:07<00:04, 382096.59it/s] 62%|██████▏   | 2947841/4762678 [00:07<00:10, 177462.35it/s] 63%|██████▎   | 2991791/4762678 [00:07<00:08, 216118.39it/s] 64%|██████▍   | 3036623/4762678 [00:08<00:06, 255876.56it/s] 65%|██████▍   | 3081786/4762678 [00:08<00:05, 294120.94it/s] 66%|██████▌   | 3126663/4762678 [00:08<00:04, 328032.05it/s] 67%|██████▋   | 3172134/4762678 [00:08<00:04, 357947.85it/s] 68%|██████▊   | 3215899/4762678 [00:08<00:04, 378633.37it/s] 68%|██████▊   | 3258693/4762678 [00:08<00:04, 370244.17it/s] 69%|██████▉   | 3299211/4762678 [00:08<00:04, 358922.66it/s] 70%|███████   | 3337624/4762678 [00:08<00:04, 351227.04it/s] 71%|███████   | 3374548/4762678 [00:08<00:04, 346464.34it/s] 72%|███████▏  | 3410470/4762678 [00:08<00:03, 343078.33it/s] 72%|███████▏  | 3445679/4762678 [00:09<00:03, 337208.91it/s] 73%|███████▎  | 3485222/4762678 [00:09<00:03, 352790.41it/s] 74%|███████▍  | 3527215/4762678 [00:09<00:03, 370562.93it/s] 75%|███████▍  | 3570212/4762678 [00:09<00:03, 386585.19it/s] 76%|███████▌  | 3611549/4762678 [00:09<00:02, 394247.98it/s] 77%|███████▋  | 3654202/4762678 [00:09<00:02, 403406.59it/s] 78%|███████▊  | 3697929/4762678 [00:09<00:02, 413001.63it/s] 79%|███████▊  | 3742492/4762678 [00:09<00:02, 422277.01it/s] 80%|███████▉  | 3787238/4762678 [00:09<00:02, 429528.10it/s] 80%|████████  | 3833114/4762678 [00:09<00:02, 437897.52it/s] 81%|████████▏ | 3879747/4762678 [00:10<00:01, 446053.20it/s] 82%|████████▏ | 3925335/4762678 [00:10<00:01, 448956.28it/s] 83%|████████▎ | 3970361/4762678 [00:10<00:01, 447584.75it/s] 84%|████████▍ | 4015212/4762678 [00:10<00:01, 443343.83it/s] 85%|████████▌ | 4059620/4762678 [00:10<00:01, 433699.67it/s] 86%|████████▌ | 4103511/4762678 [00:10<00:01, 435246.77it/s] 87%|████████▋ | 4149941/4762678 [00:10<00:01, 443569.84it/s] 88%|████████▊ | 4196456/4762678 [00:10<00:01, 449829.86it/s] 89%|████████▉ | 4242499/4762678 [00:10<00:01, 452957.47it/s] 90%|█████████ | 4288094/4762678 [00:10<00:01, 453850.26it/s] 91%|█████████ | 4333524/4762678 [00:11<00:00, 452231.65it/s] 92%|█████████▏| 4378780/4762678 [00:11<00:00, 440740.26it/s] 93%|█████████▎| 4423131/4762678 [00:11<00:00, 441564.84it/s] 94%|█████████▍| 4467349/4762678 [00:11<00:00, 438632.29it/s] 95%|█████████▍| 4511260/4762678 [00:11<00:00, 437271.44it/s] 96%|█████████▌| 4555046/4762678 [00:11<00:00, 437447.34it/s] 97%|█████████▋| 4598815/4762678 [00:11<00:00, 436048.40it/s] 97%|█████████▋| 4642438/4762678 [00:11<00:00, 431952.44it/s] 98%|█████████▊| 4685655/4762678 [00:11<00:00, 429582.70it/s] 99%|█████████▉| 4728632/4762678 [00:12<00:00, 427389.47it/s]100%|██████████| 4762678/4762678 [00:12<00:00, 393602.40it/s]
/home/mrdouglas/ogb/ogb/linkproppred/evaluate.py:235: UserWarning: This overload of nonzero is deprecated:
	nonzero()
Consider using one of the following signatures instead:
	nonzero(*, bool as_tuple) (Triggered internally at  /pytorch/torch/csrc/utils/python_arg_parser.cpp:766.)
  ranking_list = (argsort == 0).nonzero()
Traceback (most recent call last):
  File "run.py", line 372, in <module>
    main(parse_args())
  File "run.py", line 368, in main
    metrics = kge_model.test_step(kge_model, small_train_triples, args, entity_dict, random_sampling=True)
  File "/home/mrdouglas/ogb/examples/linkproppred/biokg/model.py", line 345, in test_step
    for positive_sample, negative_sample, mode in test_dataset:
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 363, in __next__
    data = self._next_data()
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 989, in _next_data
    return self._process_data(data)
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1014, in _process_data
    data.reraise()
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/_utils.py", line 395, in reraise
    raise self.exc_type(msg)
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/utils/data/_utils/worker.py", line 185, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 47, in fetch
    return self.collate_fn(data)
  File "/home/mrdouglas/ogb/examples/linkproppred/biokg/dataloader.py", line 103, in collate_fn
    negative_sample = torch.stack([_[1] for _ in data], dim=0)
RuntimeError: stack expects each tensor to be equal size, but got [45086] at entry 0 and [10688] at entry 2

