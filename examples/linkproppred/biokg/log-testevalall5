  0%|          | 0/4762678 [00:00<?, ?it/s]  0%|          | 5796/4762678 [00:00<01:22, 57959.64it/s]  1%|          | 50109/4762678 [00:00<01:00, 78404.02it/s]  2%|▏         | 95933/4762678 [00:00<00:44, 104353.65it/s]  3%|▎         | 144448/4762678 [00:00<00:33, 136494.05it/s]  4%|▍         | 192569/4762678 [00:00<00:26, 173856.77it/s]  5%|▌         | 241356/4762678 [00:00<00:20, 215460.32it/s]  6%|▌         | 289866/4762678 [00:00<00:17, 258578.93it/s]  7%|▋         | 335046/4762678 [00:00<00:14, 295751.47it/s]  8%|▊         | 383789/4762678 [00:00<00:13, 335307.76it/s]  9%|▉         | 431884/4762678 [00:01<00:11, 368811.85it/s] 10%|█         | 480699/4762678 [00:01<00:10, 398000.19it/s] 11%|█         | 530490/4762678 [00:01<00:09, 423493.03it/s] 12%|█▏        | 578130/4762678 [00:01<00:14, 294559.55it/s] 13%|█▎        | 627623/4762678 [00:01<00:12, 335280.24it/s] 14%|█▍        | 675301/4762678 [00:01<00:11, 368047.83it/s] 15%|█▌        | 721897/4762678 [00:01<00:10, 392808.87it/s] 16%|█▌        | 768471/4762678 [00:01<00:09, 412169.98it/s] 17%|█▋        | 817258/4762678 [00:01<00:09, 432290.83it/s] 18%|█▊        | 866232/4762678 [00:02<00:08, 448057.98it/s] 19%|█▉        | 914843/4762678 [00:02<00:08, 458830.67it/s] 20%|██        | 962354/4762678 [00:02<00:08, 461372.82it/s] 21%|██▏       | 1014319/4762678 [00:02<00:07, 477433.33it/s] 22%|██▏       | 1065830/4762678 [00:02<00:07, 488144.10it/s] 23%|██▎       | 1115363/4762678 [00:02<00:07, 476672.43it/s] 24%|██▍       | 1163593/4762678 [00:02<00:07, 474227.28it/s] 25%|██▌       | 1211573/4762678 [00:02<00:07, 475884.91it/s] 26%|██▋       | 1259441/4762678 [00:02<00:07, 460213.61it/s] 27%|██▋       | 1305770/4762678 [00:03<00:07, 458811.27it/s] 28%|██▊       | 1351868/4762678 [00:03<00:07, 453443.70it/s] 29%|██▉       | 1397378/4762678 [00:03<00:07, 452153.33it/s] 30%|███       | 1442710/4762678 [00:03<00:07, 451879.19it/s] 31%|███▏      | 1489307/4762678 [00:03<00:07, 456014.98it/s] 32%|███▏      | 1534975/4762678 [00:03<00:12, 261368.74it/s] 33%|███▎      | 1573743/4762678 [00:03<00:11, 289682.69it/s] 34%|███▍      | 1610819/4762678 [00:03<00:10, 310020.16it/s] 35%|███▍      | 1648011/4762678 [00:04<00:09, 326312.42it/s] 35%|███▌      | 1687103/4762678 [00:04<00:08, 343332.89it/s] 36%|███▌      | 1725351/4762678 [00:04<00:08, 354208.81it/s] 37%|███▋      | 1763793/4762678 [00:04<00:08, 362759.43it/s] 38%|███▊      | 1802354/4762678 [00:04<00:08, 369324.94it/s] 39%|███▊      | 1840948/4762678 [00:04<00:07, 374155.05it/s] 39%|███▉      | 1879237/4762678 [00:04<00:07, 374132.39it/s] 40%|████      | 1917262/4762678 [00:04<00:07, 370701.99it/s] 41%|████      | 1954768/4762678 [00:04<00:07, 371583.12it/s] 42%|████▏     | 1992500/4762678 [00:04<00:07, 373283.51it/s] 43%|████▎     | 2030596/4762678 [00:05<00:07, 375552.56it/s] 43%|████▎     | 2068306/4762678 [00:05<00:07, 374366.85it/s] 44%|████▍     | 2105893/4762678 [00:05<00:07, 374815.57it/s] 45%|████▌     | 2144039/4762678 [00:05<00:06, 376782.18it/s] 46%|████▌     | 2181893/4762678 [00:05<00:06, 377306.84it/s] 47%|████▋     | 2219663/4762678 [00:05<00:06, 372191.96it/s] 47%|████▋     | 2256926/4762678 [00:05<00:07, 351604.80it/s] 48%|████▊     | 2292353/4762678 [00:05<00:07, 349724.16it/s] 49%|████▉     | 2327514/4762678 [00:05<00:06, 350194.06it/s] 50%|████▉     | 2362666/4762678 [00:06<00:06, 347189.10it/s] 50%|█████     | 2397484/4762678 [00:06<00:06, 341972.17it/s] 51%|█████     | 2432417/4762678 [00:06<00:06, 344145.17it/s] 52%|█████▏    | 2467669/4762678 [00:06<00:06, 346613.93it/s] 53%|█████▎    | 2502987/4762678 [00:06<00:06, 348555.61it/s] 53%|█████▎    | 2538325/4762678 [00:06<00:06, 349986.41it/s] 54%|█████▍    | 2573351/4762678 [00:06<00:06, 349954.46it/s] 55%|█████▍    | 2608366/4762678 [00:06<00:06, 343515.22it/s] 55%|█████▌    | 2642758/4762678 [00:06<00:06, 342045.78it/s] 56%|█████▌    | 2677470/4762678 [00:06<00:06, 343550.55it/s] 57%|█████▋    | 2712301/4762678 [00:07<00:05, 344964.04it/s] 58%|█████▊    | 2746922/4762678 [00:07<00:05, 345335.01it/s] 58%|█████▊    | 2781468/4762678 [00:07<00:05, 344402.04it/s] 59%|█████▉    | 2816203/4762678 [00:07<00:05, 345280.76it/s] 60%|█████▉    | 2850912/4762678 [00:07<00:05, 345819.43it/s] 61%|██████    | 2885936/4762678 [00:07<00:05, 347131.72it/s] 61%|██████▏   | 2921665/4762678 [00:07<00:05, 349095.12it/s] 62%|██████▏   | 2956581/4762678 [00:08<00:11, 162918.69it/s] 63%|██████▎   | 2993315/4762678 [00:08<00:09, 195568.00it/s] 64%|██████▎   | 3033370/4762678 [00:08<00:07, 231038.09it/s] 65%|██████▍   | 3077017/4762678 [00:08<00:06, 269023.67it/s] 66%|██████▌   | 3120845/4762678 [00:08<00:05, 304274.48it/s] 66%|██████▋   | 3164436/4762678 [00:08<00:04, 334585.34it/s] 67%|██████▋   | 3205570/4762678 [00:08<00:04, 354424.95it/s] 68%|██████▊   | 3247320/4762678 [00:08<00:04, 371249.52it/s] 69%|██████▉   | 3289587/4762678 [00:08<00:03, 385310.56it/s] 70%|██████▉   | 3331928/4762678 [00:08<00:03, 396000.06it/s] 71%|███████   | 3373466/4762678 [00:09<00:03, 400117.67it/s] 72%|███████▏  | 3414845/4762678 [00:09<00:03, 403076.80it/s] 73%|███████▎  | 3456695/4762678 [00:09<00:03, 407576.93it/s] 73%|███████▎  | 3499208/4762678 [00:09<00:03, 412686.85it/s] 74%|███████▍  | 3542482/4762678 [00:09<00:02, 418504.15it/s] 75%|███████▌  | 3585756/4762678 [00:09<00:02, 422674.51it/s] 76%|███████▌  | 3628290/4762678 [00:09<00:02, 417049.04it/s] 77%|███████▋  | 3670199/4762678 [00:09<00:02, 414016.44it/s] 78%|███████▊  | 3711749/4762678 [00:09<00:02, 413976.12it/s] 79%|███████▉  | 3754710/4762678 [00:10<00:02, 418544.73it/s] 80%|███████▉  | 3796649/4762678 [00:10<00:02, 418495.88it/s] 81%|████████  | 3839621/4762678 [00:10<00:02, 421798.52it/s] 82%|████████▏ | 3882671/4762678 [00:10<00:02, 424357.26it/s] 82%|████████▏ | 3925144/4762678 [00:10<00:01, 418887.80it/s] 83%|████████▎ | 3967075/4762678 [00:10<00:01, 416200.03it/s] 84%|████████▍ | 4009489/4762678 [00:10<00:01, 418550.46it/s] 85%|████████▌ | 4051371/4762678 [00:10<00:01, 409752.79it/s] 86%|████████▌ | 4092979/4762678 [00:10<00:01, 411627.57it/s] 87%|████████▋ | 4136996/4762678 [00:10<00:01, 419792.31it/s] 88%|████████▊ | 4181208/4762678 [00:11<00:01, 426250.01it/s] 89%|████████▊ | 4224761/4762678 [00:11<00:01, 428991.73it/s] 90%|████████▉ | 4268007/4762678 [00:11<00:01, 430025.87it/s] 91%|█████████ | 4311049/4762678 [00:11<00:01, 429843.97it/s] 91%|█████████▏| 4354326/4762678 [00:11<00:00, 430715.29it/s] 92%|█████████▏| 4397418/4762678 [00:11<00:00, 430322.96it/s] 93%|█████████▎| 4440532/4762678 [00:11<00:00, 430565.41it/s] 94%|█████████▍| 4483599/4762678 [00:11<00:00, 425480.81it/s] 95%|█████████▌| 4526168/4762678 [00:11<00:00, 423593.16it/s] 96%|█████████▌| 4569487/4762678 [00:11<00:00, 426425.59it/s] 97%|█████████▋| 4612146/4762678 [00:12<00:00, 426100.86it/s] 98%|█████████▊| 4654768/4762678 [00:12<00:00, 423597.63it/s] 99%|█████████▊| 4697139/4762678 [00:12<00:00, 417767.49it/s]100%|█████████▉| 4739097/4762678 [00:12<00:00, 418307.33it/s]100%|██████████| 4762678/4762678 [00:12<00:00, 384386.05it/s]
/home/mrdouglas/ogb/ogb/linkproppred/evaluate.py:235: UserWarning: This overload of nonzero is deprecated:
	nonzero()
Consider using one of the following signatures instead:
	nonzero(*, bool as_tuple) (Triggered internally at  /pytorch/torch/csrc/utils/python_arg_parser.cpp:766.)
  ranking_list = (argsort == 0).nonzero()
Traceback (most recent call last):
  File "run.py", line 372, in <module>
    main(parse_args())
  File "run.py", line 356, in main
    metrics = kge_model.test_step(kge_model, test_triples, args, entity_dict, random_sampling=args.test_random_sample>0)
  File "/home/mrdouglas/ogb/examples/linkproppred/biokg/model.py", line 345, in test_step
    for positive_sample, negative_sample, mode in test_dataset:
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 363, in __next__
    data = self._next_data()
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 989, in _next_data
    return self._process_data(data)
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1014, in _process_data
    data.reraise()
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/_utils.py", line 395, in reraise
    raise self.exc_type(msg)
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/utils/data/_utils/worker.py", line 185, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/mrdouglas/graphs/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 47, in fetch
    return self.collate_fn(data)
  File "/home/mrdouglas/ogb/examples/linkproppred/biokg/dataloader.py", line 103, in collate_fn
    negative_sample = torch.stack([_[1] for _ in data], dim=0)
RuntimeError: stack expects each tensor to be equal size, but got [10001] at entry 0 and [9970] at entry 13

